{% extends 'base.html' %}
{% block content %}
<div class='container-fluid'>
  <!-- Header -->
  <div class='row mb-4'>
    <div class='col'>
      <h1><i class='bi bi-folder'></i> {{ project.project_name }}</h1>
    </div>
    <div class='col-auto'>
      <a href='/projects/{{project.id}}/edit' class='btn btn-warning'>
        <i class='bi bi-pencil'></i> Edit
      </a>
      <a href='/projects' class='btn btn-secondary'>
        <i class='bi bi-arrow-left'></i> Back
      </a>
    </div>
  </div>

  <!-- Project Details Card -->
  <div class='row mb-4'>
    <div class='col-lg-8'>
      <div class='card'>
        <div class='card-header'>
          <h5 class='mb-0'><i class='bi bi-info-circle'></i> Project Information</h5>
        </div>
        <div class='card-body'>
          <div class='row mb-3'>
            <div class='col-md-6'>
              <p class='text-muted mb-1'>Project Code</p>
              <p class='fs-5'><strong>{{ project.project_code }}</strong></p>
            </div>
            <div class='col-md-6'>
              <p class='text-muted mb-1'>Status</p>
              <p>
                <span class='status-{{project.status.lower().replace(" ", "-")}}'>
                  {{ project.status }}
                </span>
              </p>
            </div>
          </div>
          <div class='row mb-3'>
            <div class='col-md-6'>
              <p class='text-muted mb-1'>Client Name</p>
              <p>{{ project.client_name or '—' }}</p>
            </div>
            <div class='col-md-6'>
              <p class='text-muted mb-1'>Created Date</p>
              <p>{{ project.created_at.strftime('%Y-%m-%d %H:%M:%S') if project.created_at else 'N/A' }}</p>
            </div>
          </div>
          {% if project.description %}
            <div class='row'>
              <div class='col-12'>
                <p class='text-muted mb-1'>Description</p>
                <p>{{ project.description }}</p>
              </div>
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Statistics -->
    <div class='col-lg-4'>
      <div class='card bg-primary text-white mb-3'>
        <div class='card-body'>
          <h6 class='card-title'>Total Samples</h6>
          <h2 class='mb-0'>{{ samples|length }}</h2>
        </div>
      </div>
      <div class='card bg-info text-white'>
        <div class='card-body'>
          <h6 class='card-title'>Total Tests</h6>
          <h2 class='mb-0'>
            {% set test_count = 0 %}
            {% for s in samples %}{{ test_count + s.tests|length }}{% endfor %}
          </h2>
        </div>
      </div>
    </div>
  </div>

  <!-- Samples Section -->
  <div class='row'>
    <div class='col-12'>
      <div class='card'>
        <div class='card-header'>
          <h5 class='mb-0'><i class='bi bi-vial'></i> Samples in this Project</h5>
        </div>
        <div class='card-body'>
          {% if samples %}
            <div class='table-responsive'>
              <table class='table table-hover'>
                <thead>
                  <tr>
                    <th>Sample ID</th>
                    <th>Type</th>
                    <th>Date Collected</th>
                    <th style='width: 150px;'>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  {% for s in samples %}
                    <tr>
                      <td><strong>{{ s.sample_id }}</strong></td>
                      <td>
                        <span class='badge bg-secondary'>{{ s.sample_type }}</span>
                      </td>
                      <td>{{ s.date_collected or '—' }}</td>
                      <td>
                        <a href='/samples/{{s.id}}' class='btn btn-sm btn-outline-primary'>
                          <i class='bi bi-eye'></i> View
                        </a>
                      </td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% else %}
            <div class='alert alert-info mb-0'>
              <i class='bi bi-info-circle'></i> No samples registered for this project yet.
              <a href='/samples/new' class='alert-link'>Register a new sample</a>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
