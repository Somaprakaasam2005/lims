<!doctype html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <title>Civil Eng LIMS</title>
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css' rel='stylesheet'>
    <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css'>
    <link rel='stylesheet' href='/static/style.css'>
  </head>
  <body>
    <!-- Navigation -->
    <nav class='navbar navbar-expand-lg navbar-dark bg-dark sticky-top'>
      <div class='container-fluid'>
        <a class='navbar-brand' href='/'>
          <i class='bi bi-flask'></i> Civil Eng LIMS
        </a>
        <button class='navbar-toggler' type='button' data-bs-toggle='collapse' data-bs-target='#navbarNav'>
          <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarNav'>
          <ul class='navbar-nav ms-auto'>
            <li class='nav-item'>
              <a class='nav-link' href='/'><i class='bi bi-speedometer2'></i> Dashboard</a>
            </li>
            <li class='nav-item'>
              <a class='nav-link' href='/projects'><i class='bi bi-folder'></i> Projects</a>
            </li>
            <li class='nav-item'>
              <a class='nav-link' href='/samples'><i class='bi bi-vial'></i> Samples</a>
            </li>
            <li class='nav-item dropdown'>
              <a class='nav-link dropdown-toggle' href='#' id='exportDropdown' role='button' data-bs-toggle='dropdown'>
                <i class='bi bi-download'></i> Export
              </a>
              <ul class='dropdown-menu'>
                <li><a class='dropdown-item' href='/export/samples'>Export Samples</a></li>
                <li><a class='dropdown-item' href='/export/tests'>Export Tests</a></li>
              </ul>
            </li>
            {% if current_user.role == 'Admin' %}
              <li class='nav-item dropdown'>
                <a class='nav-link dropdown-toggle' href='#' id='adminDropdown' role='button' data-bs-toggle='dropdown'>
                  <i class='bi bi-gear'></i> Admin
                </a>
                <ul class='dropdown-menu'>
                  <li><a class='dropdown-item' href='/users'><i class='bi bi-people'></i> Users</a></li>
                  <li><a class='dropdown-item' href='/audit/logs'><i class='bi bi-clock-history'></i> Audit Logs</a></li>
                </ul>
              </li>
            {% endif %}
            <li class='nav-item dropdown'>
              <a class='nav-link dropdown-toggle' href='#' id='userDropdown' role='button' data-bs-toggle='dropdown'>
                <i class='bi bi-person-circle'></i> {{ current_user.username }}
              </a>
              <ul class='dropdown-menu'>
                <li><a class='dropdown-item' href='/logout'><i class='bi bi-box-arrow-right'></i> Logout</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for cat, msg in messages %}
          <div class='alert alert-{% if cat == "danger" %}danger{% elif cat == "success" %}success{% elif cat == "warning" %}warning{% else %}info{% endif %} alert-dismissible fade show' role='alert' style='margin: 0; border-radius: 0;'>
            {{ msg }}
            <button type='button' class='btn-close' data-bs-dismiss='alert'></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <!-- Main Content -->
    <main class='container-fluid py-4'>
      {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class='bg-dark text-light text-center py-4 mt-5'>
      <p class='mb-0'>&copy; 2025 Civil Engineering LIMS. All rights reserved.</p>
    </footer>

    <script src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js'></script>
  </body>
</html>
